rules:
  # Web Servers
  - name: "Apache"
    part: "header"
    regex: "(?i)(Server:.*Apache|X-Powered-By:.*Apache)"
  - name: "Nginx"
    part: "header"
    regex: "(?i)(Server:.*nginx|X-Powered-By:.*nginx)"
  - name: "IIS"
    part: "header"
    regex: "(?i)(Server:.*Microsoft-IIS|X-Powered-By:.*ASP\\.NET)"
  - name: "Lighttpd"
    part: "header"
    regex: "(?i)Server:.*lighttpd"
  - name: "Caddy"
    part: "header"
    regex: "(?i)Server:.*Caddy"
  - name: "OpenResty"
    part: "header"
    regex: "(?i)Server:.*openresty"
  - name: "Tomcat"
    part: "header"
    regex: "(?i)(Server:.*Apache-Coyote|X-Powered-By:.*Tomcat)"
  - name: "Jetty"
    part: "header"
    regex: "(?i)Server:.*Jetty"
  
  # Languages/Platforms
  - name: "PHP"
    part: "header"
    regex: "(?i)(X-Powered-By:.*PHP|Set-Cookie:.*PHPSESSID)"
  - name: "ASP.NET"
    part: "header"
    regex: "(?i)(X-Powered-By:.*ASP\\.NET|Set-Cookie:.*ASPSESSION|Set-Cookie:.*ASP.NET_SessionId)"
  - name: "Java"
    part: "header"
    regex: "(?i)(JSESSIONID|Java)"
  - name: "Python"
    part: "header"
    regex: "(?i)(Server:.*Python|X-Powered-By:.*Python)"
  - name: "Ruby"
    part: "header"
    regex: "(?i)(Server:.*Ruby|X-Powered-By:.*Ruby)"
  - name: "Perl"
    part: "header"
    regex: "(?i)(Server:.*Perl|X-Powered-By:.*Perl)"
  - name: "Node.js"
    part: "header"
    regex: "(?i)X-Powered-By:.*Node\\.js"

  # CMS / Frameworks
  - name: "WordPress"
    part: "body"
    regex: "(?i)(wp-content|wp-includes|wp-json|wp-admin)"
  - name: "Drupal"
    part: "header"
    regex: "(?i)(X-Generator:.*Drupal|X-Drupal-Cache)"
  - name: "Joomla"
    part: "body"
    regex: "(?i)(content=\"Joomla!|/templates/system/css/system.css)"
  - name: "Magento"
    part: "body"
    regex: "(?i)(Mage\\.Cookies|/skin/frontend/|var isIE)"
  - name: "Laravel"
    part: "header"
    regex: "(?i)(laravel_session|X-Powered-By:.*Laravel)"
  - name: "Django"
    part: "body"
    regex: "(?i)(csrfmiddlewaretoken|__admin_media_prefix__)"
  - name: "Rails"
    part: "header"
    regex: "(?i)(X-Powered-By:.*Phusion Passenger|X-Runtime:)"
  - name: "Spring-Boot"
    part: "header"
    regex: "(?i)X-Application-Context"
  - name: "Express"
    part: "header"
    regex: "(?i)X-Powered-By:.*Express"
  - name: "CodeIgniter"
    part: "header"
    regex: "(?i)(ci_session|X-Powered-By:.*CodeIgniter)"
  - name: "Symfony"
    part: "header"
    regex: "(?i)(X-Debug-Token|X-Symfony-Profiler)"
  - name: "Flask"
    part: "header"
    regex: "(?i)Server:.*Werkzeug"

  # JavaScript Libraries / Frameworks
  - name: "jQuery"
    part: "body"
    regex: "(?i)jquery[.-]\\d"
  - name: "React"
    part: "body"
    regex: "(?i)(react\\.production\\.min\\.js|data-reactid)"
  - name: "Angular"
    part: "body"
    regex: "(?i)(ng-version|angular\\.js)"
  - name: "Vue.js"
    part: "body"
    regex: "(?i)(vue\\.js|data-v-)"
  - name: "Bootstrap"
    part: "body"
    regex: "(?i)bootstrap(?:\\.min)?\\.css"
  - name: "Lodash"
    part: "body"
    regex: "(?i)lodash\\.js"
  - name: "Moment.js"
    part: "body"
    regex: "(?i)moment\\.js"
  - name: "Backbone.js"
    part: "body"
    regex: "(?i)backbone(?:\\.min)?\\.js"

  # OS
  - name: "Ubuntu"
    part: "header"
    regex: "(?i)Ubuntu"
  - name: "Debian"
    part: "header"
    regex: "(?i)Debian"
  - name: "CentOS"
    part: "header"
    regex: "(?i)CentOS"
  - name: "Fedora"
    part: "header"
    regex: "(?i)Fedora"
  - name: "FreeBSD"
    part: "header"
    regex: "(?i)FreeBSD"
  - name: "Windows"
    part: "header"
    regex: "(?i)Windows"

  # Infrastructure / DevOps
  - name: "OpenSSL"
    part: "header"
    regex: "(?i)OpenSSL"
  - name: "Cloudflare"
    part: "header"
    regex: "(?i)(Server:.*cloudflare|cf-ray)"
  - name: "Docker"
    part: "header"
    regex: "(?i)Server:.*Docker"
  - name: "Kubernetes"
    part: "header"
    regex: "(?i)X-Kubernetes-Master"
  - name: "Swagger"
    part: "body"
    regex: "(?i)swagger-ui"
  - name: "Grafana"
    part: "body"
    regex: "(?i)(grafana|x-grafana-org-id)"
  - name: "Kibana"
    part: "header"
    regex: "(?i)(kbn-name|Server:.*Kibana)"
  - name: "Elasticsearch"
    part: "header"
    regex: "(?i)Server:.*Elasticsearch"
  - name: "ClickHouse"
    part: "header"
    regex: "(?i)Server:.*ClickHouse"
  - name: "Dgraph"
    part: "header"
    regex: "(?i)Server:.*Dgraph"
  - name: "Zipkin"
    part: "header"
    regex: "(?i)Server:.*Zipkin"
  - name: "Netdata"
    part: "header"
    regex: "(?i)Server:.*Netdata"
  - name: "GitLab"
    part: "header"
    regex: "(?i)Server:.*GitLab"
  - name: "Consul"
    part: "header"
    regex: "(?i)Server:.*Consul"
  - name: "Prometheus"
    part: "header"
    regex: "(?i)Server:.*Prometheus"
  - name: "Jenkins"
    part: "header"
    regex: "(?i)X-Jenkins"
  - name: "RabbitMQ"
    part: "body"
    regex: "(?i)RabbitMQ Management"
  - name: "Prometheus"
    part: "body"
    regex: "(?i)Prometheus"

  # Security / WAF
  - name: "ModSecurity"
    part: "header"
    regex: "(?i)ModSecurity"
  - name: "Imperva"
    part: "header"
    regex: "(?i)X-Iinfo"
  - name: "Akamai"
    part: "header"
    regex: "(?i)X-Akamai-Transformed"

  # Mail Stack (Phase 1)
  - name: "SmarterMail"
    part: "all"
    regex: "(?i)(X-SM-TAGS|X-SmarterMail|smartermail)"
  - name: "Roundcube"
    part: "all"
    regex: "(?i)(roundcube|_roundcube_sessid)"
  - name: "Zimbra"
    part: "all"
    regex: "(?i)(x-zimbra|zimbra|zm-web-client)"
  - name: "SOGo"
    part: "all"
    regex: "(?i)(sogo|x-webobjects-server)"
  - name: "RainLoop"
    part: "all"
    regex: "(?i)rainloop"
  - name: "Exchange"
    part: "header"
    regex: "(?i)(microsoft exchange|x-owa-version|x-feserver|x-calculatedbetarget)"
  - name: "OWA"
    part: "all"
    regex: "(?i)(/owa/|x-owa-version|outlook web app)"
  - name: "SMTP"
    part: "body"
    regex: "(?i)(^220[ -].*(esmtp|smtp)|\\besmtp\\b)"
  - name: "IMAP"
    part: "body"
    regex: "(?i)(\\*\\s+ok.*imap|capability\\s+imap4)"
  - name: "POP3"
    part: "body"
    regex: "(?i)(^\\+ok.*pop3|\\bpop3\\b)"
  - name: "Postfix"
    part: "body"
    regex: "(?i)postfix"
  - name: "Exim"
    part: "body"
    regex: "(?i)\\bexim\\b"
  - name: "Dovecot"
    part: "body"
    regex: "(?i)dovecot"
